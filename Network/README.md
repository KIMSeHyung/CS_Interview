# Network

* [OSI 7 Layer](#OSI-7-Layer)
* [TCP UDP 차이](#TCP-UDP-차이)
* [TCP 3 way handshake](#TCP-3-way-handshake)
* [TCP 4 way handshake](#TCK-4-way-handshake)
* 흐름제어와 혼잡제어
* [BGP 프로토콜](#BGP-프로토콜)

<br>

---

## OSI 7 Layer

* OSI 참조 모델은 네트워킹 시스템 구조를 위한 통합 표준을 위해 만들어졌다.
    * OSI 참조 모델은 원래 개념/교육용이 아니라, 인터네트워크에서 사용할 프로토콜 슈트 개발을 위해 만들어졌다. 하지만 인터넷과 TCP/IP가 성장하여 OSI 프로토콜은 사장되었다.
    * OSI 모델이 네트워크를 이해하기 위한 구조를 정의하기는 하지만 모든 네트워킹 구성 요소, 프로토콜, 기술이 OSI 모델의 계층 구조에 정확히 들어 맞는 것은 아니다.
* OSI 참조 모델 계층
    * 애플리케이션
        * 역할 : 사용자 애플리케이션 서비스 제공
        * 데이터 유닛 : 메세지, 사용자 데이터
        * 대표 프로토콜 : HTTP, FTP, SMTP, DHCP, NFS, Telnet, SNMP, POP3
    * 프리젠테이션
        * 역할 : 번역(Translation), 압축, 암호화
        * 데이터 유닛 : 인코딩 데이터
        * 대표 프로토콜 : MIME, SSL(세션 계층으로 보기도 함)
    * 세션
        * 역할 : 세션 생성/유지/종료, 인터페이스
        * 데이터 유닛 : 세션
        * 대표 프로토콜 : NetBIOS, RPC, 소켓
    * 전송
        * 역할 : 프로세스 수준 주소 지정, 다중화와 역다중화, 단편화/패키징/재조합, 연결 수립/유지/종료, 승인 및 재전송, 흐름 제어
        * 데이터 유닛 : 세그먼트
        * 대표 프로토콜 : TCP, UDP
    * 네트워크
        * 역할 : 논리적 주소 지정, 라우팅, 데이터그램 캡슐화, 단편화와 재조합, 에러 처리 및 진단
        * 데이터 유닛 : 패킷, 데이터그램
        * 대표 프로토콜 : IP, ICMP, ARP, RIP, OSPF, BGP
    * 데이터링크
        * 역할 : 논리적 연결 제어(LLC, Logical Link Control), 매체 접근 제어(MAC, Media Access Control), 데이터 프레이밍(Data Framing), 주소 지정, 에러 탐지 및 처리, 물리 계층 표준 명시
        * 데이터 유닛 : 프레임
        * 대표 프로토콜 : 이더넷, HDLC, PPP, 802.11
    * 물리
        * 역할 : 하드웨어 명세 정의, 인코딩, 물리적 데이터 송수신, 토폴로지와 물리 네트워크 설계
        * 데이터 유닛 : 비트

## TCP UDP 차이

* TCP
    * 애플리케이션이 데이터를 안정적으로 송수신할 수 있도록 하는 프로토콜
    * 연결형 프로토콜로 전송 전에 먼저 연결을 맺어야 한다.
    * 스트림 기반으로 데이터의 경계(boundary)가 없다.
    * 메시지 전송을 신뢰할 수 있으며 모든 데이터에 대한 승인이 있다.
    * 모든 데이터 전송을 관리하며, 손실된 데이터는 자동으로 재전송한다.
    * 슬라이딩 윈도우를 이용하여 흐름 제어를 한다. 또한 윈도우 크기를 조정하고 혼잡 회피 알고리즘을 사용한다.
    * UDP에 비하면 느리고 부하가 생긴다. (절대적인 수치가 낮은 것은 아니다.)
    * 신뢰할 수 있는 방법으로 데이터를 송수신 해야 하는 애플리케이션에 적합하다.
    * FTP, Telnet, SMTP, DNS(메시지가 512B를 초과하거나 Zone File 송수신 경우), HTTP(1.0 ~ 2.0), POP, BGP
* UDP
    * 단순하고 빠르게 애플리케이션이 네트워크 계층에 접근할 수 있도록 하는 인터페이스를 제공하는 프로토콜
    * 비연결형 프로토콜로 연결 수립 없이 데이터를 송수신한다.
    * 메시지 기반으로 데이터의 경계(boundary)가 있다.
    * 메시지 전송에 대한 신뢰성이 없다.
    * 자체적으로 재전송을 수행하지 않는다.
    * 데이터 흐름 관리 기능이 없다.
    * 부하와 전송속도가 매우 빠르다.
    * 데이터의 완전성보다 전달 속도가 중요한 애플리케이션에 적합하다.
    * 멀티미디어 애플리케이션, DNS(일반적인 쿼리 경우), DHCP, RIP, SNMP, HTTP(3.0, QUIC)

## TCP 3 way handshake

* TCP 통신을 하기 위하여 클라이언트와 서버 간에 SYN, SYN/ACK, ACK 세 번의 트랜잭션을 주고 받아서 연결을 맺는 과정
1. 클라이언트 -> 서버 : SYN
    * 클라이언트가 서버에게 임의의 SEQ 넘버로 SYN 플래그가 설정된 패킷을 송신한다.
    * PORT 상태 : 클라이언트(SYN_SENT), 서버(LISTEN)
2. 서버 -> 클라이언트 : SYN + ACK
    * 서버는 SEQ 넘버를 랜덤, ACK 넘버를 수신한 SEQ + 1로 지정하고, SYN과 ACK 플래그를 설정한 패킷을 송신한다.
    * PORT 상태 : 서버(SYN_RCVD), 클라이언트(SYN_SENT)
3. 클라이언트 -> 서버 : ACK
    * 클라이언트는 SEQ 넘버를 수신한 ACK, ACK 넘버를 수신한 SEQ + 1로 지정하고, ACK 플래그를 설정한 패킷을 송신한다.
    * PORT 상태 : 클라이언트(ESTABLISHED), 서버(ESTABLISHED)

## TCP 4 way handshake

* TCP 연결을 안정적으로 해제하기 위하여 클라이언트와 서버 간에 FIN, ACK, FIN, ACK 네 번의 트랜잭션을 주고 받는 과정
1. 클라이언트 -> 서버 : FIN
    * 클라이언트가 서버에게 FIN 플래그가 설정된 패킷을 송신한다.
    * PORT 상태 : 클라이언트(FIN_WAIT1), 서버(ESTABLISHED)
2. 서버 -> 클라이언트 : ACK
    * 서버가 클라이언트에게 ACK 플래그가 설정된 패킷을 송신한다.
    * PORT 상태 : 서버(CLOSE_WAIT), 클라이언트(FIN_WAIT2)
3. 서버 -> 클라이언트 : FIN
    * 서버가 클라이언트에게 FIN 플래그가 설정된 패킷을 송신한다.
    * PORT 상태 : 서버(LAST_ACK), 클라이언트(FIN_WAIT2)
4. 클라이언트 -> 서버 : ACK
    * 클라이언트가 서버에게 ACK 플래그가 설정된 패킷을 송신한다.
    * PORT 상태 : 클라이언트(TIME_WAIT), 서버(CLOSED)

## BGP 프로토콜

* 현대 TCP/IP에서 사용하는 외부 라우팅 프로토콜은 BGP이다. BGP는 EGP를 대체하기 위해 개발되고 개정되어 현재는 BGP-4 버전을 사용한다. BGP 프로토콜은 AS(Autonomous System, 자치 시스템)간에 네트워크 접근 가능 정보를 교환하고 그 정보를 통해 네트워크 경로를 결정한다.
* 각 AS는 BGP 소프트웨어를 실행하는 하나 이상의 라우터가 있어야 하며, BGP 라우터는 서로 연결되어 있어야 한다.
* BGP 라우터는 네트워크에 관한 정보와 경로를 라우팅 정보 기반(RIB)에 저장하고 BGP 라우터끼리 라우팅 정보를 교환하여 인터네트워크에 전파한다.
