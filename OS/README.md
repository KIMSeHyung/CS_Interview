# Operating System

* [프로세스와 쓰레드의 차이](#프로세스와-쓰레드의-차이)
* 데드락의 발생 조건
* 가상메모리
* 선점형 스케줄링과 비선점형 스케줄링
* 컨텍스트 스위칭

---

## 프로세스와 쓰레드의 차이

* 공룡책 등에 소개되는 개념에 의하면 프로세스는 실행 혹은 실행 가능 상태에 있는 프로그램 인스턴스이고, 쓰레드는 프로세스 안에서 실행되는 흐름의 단위로 CPU 이용의 기본 단위이다.
* 프로세스는 Code, Data, Heap, Stack 세그먼트를 갖는다.
    * Code 세그먼트는 프로그램 명령어를 구성하는 메모리 영역이다.
    * Data 세그먼트는 전역/정적 변수를 저장하는 영역이다.
        * 읽기 전용 데이터는 .rodata, 초기화 된 데이터는 .data, 초기화 되지 않은 데이터는 .bss 영역에 저장한다.
    * Heap 세그먼트는 동적 할당 시 사용한다.
    * Stack 세그먼트는 함수의 스택 프레임(지역 변수, 매개 변수, 리턴 값 등)을 구성할 때 사용한다.
* 이론적으로 프로세스는 각각 독립된 메모리 영역을 할당받아서, 한 프로세스는 다른 프로세스의 메모리에 접근할 수 없다.
* 이론적으로 쓰레드는 프로세스 내에서 레지스터와 Stack 세그먼트만 따로 할당받고, 그 외의 세그먼트는 공유한다.
* 실제 구현상(UNIX, Linux, MAC OS, Windows 등) 위의 내용은 정확하지 않을 수 있다.
    * 예를 들어 Linux에서는 프로세스와 쓰레드를 모두 ```task_struct``` 구조체로 표현한다. 리눅스 커널에서 새로운 프로세스나 쓰레드를 생성할때 ```kernel_clone()``` 함수를 사용한다. (과거 ```_do_fork()``` 함수였다가 이름 변경됨) 저 함수 내에서 ```copy_process()``` 함수를 호출하여 부모 프로세스의 여러 내용을 복사해주는데, 유저 스페이스로부터 전달받은 CLONE_FLAG에 따라 복사하는 내용이 달라진다. 그리고 유저 스페이스에서 호출하는 시스템콜에 따라 (프로세스 생성 시스템콜인지 쓰레드 생성 시스템콜인지 따라) 이 CLONE_FLAG가 달라지게 되어, 부모 프로세스로부터 복사받는 내용과 별개로 할당되는 내용 등의 범위가 달라지게 되는 것이다.

